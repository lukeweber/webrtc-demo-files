Index: src/voice_engine/main/source/Android.mk
===================================================================
--- src/voice_engine/main/source/Android.mk	(revision 2251)
+++ src/voice_engine/main/source/Android.mk	(working copy)
@@ -26,7 +26,6 @@
     level_indicator.cc \
     monitor_module.cc \
     output_mixer.cc \
-    ref_count.cc \
     shared_data.cc \
     statistics.cc \
     transmit_mixer.cc \
Index: src/voice_engine/main/source/voe_base_impl.cc
===================================================================
--- src/voice_engine/main/source/voe_base_impl.cc	(revision 2251)
+++ src/voice_engine/main/source/voe_base_impl.cc	(working copy)
@@ -1269,7 +1269,7 @@
 
 WebRtc_Word32 VoEBaseImpl::AddBuildInfo(char* str) const
 {
-    return sprintf(str, "Build: svn:%s %s\n", WEBRTC_SVNREVISION, BUILDINFO);
+    return sprintf(str, "Build: svn:%s %s\n", 1, BUILDINFO);
 }
 
 WebRtc_Word32 VoEBaseImpl::AddVoEVersion(char* str) const
Index: src/voice_engine/main/test/android/android_test/default.properties
===================================================================
--- src/voice_engine/main/test/android/android_test/default.properties	(revision 2251)
+++ src/voice_engine/main/test/android/android_test/default.properties	(working copy)
@@ -1,11 +1,2 @@
-# This file is automatically generated by Android Tools.
-# Do not modify this file -- YOUR CHANGES WILL BE ERASED!
-# 
-# This file must be checked in Version Control Systems.
-# 
-# To customize properties used by the Ant build system use,
-# "build.properties", and override values to adapt the script to your
-# project structure.
-
-# Project target, OpenSL ES requires API level 9 
-target=android-9
+# Project target.
+target=android-15
Index: src/voice_engine/main/test/android/android_test/jni/Android.mk
===================================================================
--- src/voice_engine/main/test/android/android_test/jni/Android.mk	(revision 2251)
+++ src/voice_engine/main/test/android/android_test/jni/Android.mk	(working copy)
@@ -57,7 +57,7 @@
     libwebrtc_agc \
     libwebrtc_aec \
     libwebrtc_aecm \
-    libwebrtc_system_wrappers \
+    libwebrtc_system_wrappers
 
 LOCAL_SHARED_LIBRARIES := \
     libcutils \
@@ -65,7 +65,7 @@
 
 LOCAL_LDLIBS := \
     -lgcc \
-    -llog
+    -llog 
 
 LOCAL_PRELINK_MODULE := false
 
@@ -108,20 +108,17 @@
 LOCAL_LDLIBS := \
     -lgcc \
     -llog \
-    -lOpenSLES
+    -lOpenSLES 
 
 LOCAL_PRELINK_MODULE := false
 
 include $(BUILD_SHARED_LIBRARY)
 
-###
 
-include $(MY_WEBRTC_ROOT_PATH)/$(MY_WEBRTC_SRC_PATH)/src/voice_engine/main/test/cmd_test/Android.mk
+include $(CLEAR_VARS)
+LOCAL_PATH := /home/luke/webrtcproj/trunk/src/voice_engine/main/test/android/android_test/jni/
 
-else
 
-LOCAL_PATH := $(call my-dir)
-
 include $(CLEAR_VARS)
 
 LOCAL_MODULE_TAGS := tests
@@ -136,17 +133,21 @@
     $(LOCAL_PATH)/../../../auto_test \
     $(LOCAL_PATH)/../../../../interface \
     $(LOCAL_PATH)/../../../../../.. \
-    $(LOCAL_PATH)/../../../../../../system_wrappers/interface
+    $(LOCAL_PATH)/../../../../../../system_wrappers/interface \
+    $(LOCAL_PATH)/../../../../../../testing/gtest/include
 
 LOCAL_PRELINK_MODULE := false
 
 LOCAL_SHARED_LIBRARIES := \
     libutils \
-    libstlport \
     libandroid \
-    libwebrtc \
-    libGLESv2
+    libGLESv2 \
+    libstlport_shared \
+    libwebrtc-voice-jni
 
+LOCAL_LDLIBS := \
+    -llog
+
 include $(BUILD_SHARED_LIBRARY)
 
 endif
Index: src/voice_engine/main/test/android/android_test/jni/Application.mk
===================================================================
--- src/voice_engine/main/test/android/android_test/jni/Application.mk	(revision 2251)
+++ src/voice_engine/main/test/android/android_test/jni/Application.mk	(working copy)
@@ -7,5 +7,7 @@
 # be found in the AUTHORS file in the root of the source tree.
 
 # Build both ARMv5TE and ARMv7-A machine code.
-APP_ABI := armeabi armeabi-v7a x86  
+APP_ABI := armeabi armeabi-v7a x86
+APP_PLATFORM := android-9
+APP_CPPFLAGS += -fno-rtti
 APP_STL := stlport_shared
Index: src/voice_engine/main/test/android/android_test/.classpath
===================================================================
--- src/voice_engine/main/test/android/android_test/.classpath	(revision 2251)
+++ src/voice_engine/main/test/android/android_test/.classpath	(working copy)
@@ -1,7 +1,8 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<classpath>
-	<classpathentry kind="con" path="com.android.ide.eclipse.adt.ANDROID_FRAMEWORK"/>
-	<classpathentry kind="src" path="src"/>
-	<classpathentry kind="src" path="gen"/>
-	<classpathentry kind="output" path="bin"/>
-</classpath>
+<?xml version="1.0" encoding="UTF-8"?>
+<classpath>
+	<classpathentry kind="con" path="com.android.ide.eclipse.adt.ANDROID_FRAMEWORK"/>
+	<classpathentry kind="src" path="src"/>
+	<classpathentry kind="src" path="gen"/>
+	<classpathentry kind="con" path="com.android.ide.eclipse.adt.LIBRARIES"/>
+	<classpathentry kind="output" path="bin/classes"/>
+</classpath>
Index: src/voice_engine/main/test/android/android_test/src/org/webrtc/voiceengine/test/AndroidTest.java
===================================================================
--- src/voice_engine/main/test/android/android_test/src/org/webrtc/voiceengine/test/AndroidTest.java	(revision 2251)
+++ src/voice_engine/main/test/android/android_test/src/org/webrtc/voiceengine/test/AndroidTest.java	(working copy)
@@ -1176,6 +1176,11 @@
      * at installation time by the package manager.
      */
     static {
+    	System.loadLibrary("stlport_shared");
+    	Log.d("*Webrtc*", "Loading webrtc_audio_preprocessing...");
+        System.loadLibrary("webrtc_audio_preprocessing");
+        Log.d("*Webrtc*", "Loading webrtc-voice-jni...");
+        System.loadLibrary("webrtc-voice-jni");
         Log.d("*Webrtc*", "Loading webrtc-voice-demo-jni...");
         System.loadLibrary("webrtc-voice-demo-jni");
 
